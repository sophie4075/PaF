<div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 h-screen">
    <div class="flex justify-center items-center h-full flex-col">
        <div class="grid grid-cols-1 w-full md:grid-cols-2 gap-4">
            <!-- img -->
            <img src="{{article?.bildUrl}}" alt="Produktbild"
                 class="w-full h-auto object-cover rounded-lg"/>

            <!-- info -->
            <div class="flex flex-col justify-evenly">
                <div>
                    <h1 class="text-3xl font-bold mb-2">{{ article?.bezeichnung }}</h1>
                    <div class="font-semibold mb-4">
                        {{ article?.grundpreis }}€ <span class="text-base font-normal text-gray-600">pro Tag</span>
                    </div>
                    <p class="text-gray-700 mb-4">
                        {{ article?.beschreibung }}
                    </p>
                    <div class="mb-4">
                        <mat-form-field class="w-full">
                            <mat-label>Verfügbarkeit prüfen</mat-label>
                            <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
                                <input matStartDate formControlName="start" placeholder="Start date">
                                <input matEndDate formControlName="end" placeholder="End date">
                            </mat-date-range-input>
                            <mat-hint>MM/DD/YYYY – MM/DD/YYYY</mat-hint>
                            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-date-range-picker #picker></mat-date-range-picker>

                            @if (range.controls.start.hasError('matStartDateInvalid')) {
                                <mat-error>Invalid start date</mat-error>
                            }
                            @if (range.controls.end.hasError('matEndDateInvalid')) {
                                <mat-error>Invalid end date</mat-error>
                            }
                        </mat-form-field>
                    </div>
                </div>

                <button
                        class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded disabled:opacity-50">
                    Book that shit
                </button>
            </div>
        </div>

        @if (isAdminOrStaff) {
            <div class="bg-white rounded-lg w-full mt-8">
                <!-- Header -->
                <div class="px-4 py-2 flex justify-between items-center border-b cursor-pointer"
                     (click)="toggleInstancesPanel()">
                    <h2 class="">Artikelinstanzen verwalten</h2>
                    <svg class="w-6 h-6 transform transition-transform duration-200"
                         [ngClass]="{'rotate-180': showInstancesPanel}"
                         fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>

                @if (showInstancesPanel) {
                    @for (instance of instances; track $index) {
                        <div class="flex items-center justify-between border-b px-4 py-2">
                            <div>
                                <p class="font-semibold">{{ article?.bezeichnung }} {{ instance.inventoryNumber }}</p>
                                <p class="text-sm text-gray-600">Status: {{ instance.status }}</p>
                            </div>

                            <div class="flex justify-between">
                                @if (instance.status !== 'RENTED' && instance.status !== 'RETIRED') {
                                    <select class="border border-gray-300 rounded p-1"
                                            [(ngModel)]="instance.status"
                                            (change)="onInstanceStatusChange(instance, $index)">
                                        <option *ngFor="let s of statuses" [value]="s">{{ s }}</option>
                                    </select>
                                }

                                @if (instance.status === 'RETIRED') {
                                    <button
                                            class="bg-red-500 hover:bg-red-600 text-white rounded px-2 py-1"
                                            (click)="deleteInstance(instance, $index)">
                                        Löschen
                                    </button>
                                }
                            </div>


                        </div>

                    }

                    <div class="mt-4">
                        <button class="px-4 py-2 w-full flex justify-between items-center"
                                (click)="addInstance()">
                            Instanz hinzufügen
                            <svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon"
                                 class="size-5">
                                <path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"></path>
                            </svg>
                        </button>
                    </div>
                }

            </div>
        }
    </div>
</div>

